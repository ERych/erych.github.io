<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Elizabeth's Portfolio, Experiments in Data Science">


        <title>Choose Your News - Part 2: Using the Google Translate API to Translate International News // Elizabeth's Portfolio // Experiments in Data Science</title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./theme/css/pure.css">
    <link rel="stylesheet" href="./theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background-image: url('https://static.pexels.com/photos/205324/pexels-photo-205324.jpeg')">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <h1 class="brand-main"><a href=".">Elizabeth's Portfolio</a></h1>
                            <p class="tagline">Experiments in Data Science</p>
                                <p class="links"><a href="/category/projects.html">View Work</a></p>
                                <p class="social">
                                    <a href="https://github.com/erych">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                    <a href="https://www.linkedin.com/in/elizabeth-rychlinski-54a50a49/">
                                        <i class="fa fa-linkedin-square fa-3x"></i>
                                    </a>
                                </p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Choose Your News - Part 2: Using the Google Translate API to Translate International News</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="./tag/api.html">API</a>
                                <a class="post-category" href="./tag/google.html">Google</a>
                                <a class="post-category" href="./tag/machine-learning.html">machine learning</a>
                                <a class="post-category" href="./tag/python.html">python</a>
                        </p>
                </header>
            </section>
            <p>This is a continuation of a three-part series. To go to part one, click <a href="" title="/choose-your-news-part-1-collecting-live-news-data-using-the-news-api.html">here</a>.</p>
<h2>Analyzing Article Sources</h2>
<p>In the last article, we pulled metadata from the latest news headlines using the News API. Let's take a look at where the articles are coming from:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sources</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of News Sources&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Publication Country&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Breakdown of News Source Publication Countries&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="" src="https://github.com/ERych/erych.github.io/blob/master/images/sources.png?raw=true&quot;"></p>
<p>The articles on the News API comes from 6 different countries.</p>
<p>Now, let's look at the language of the article data:</p>
<div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sources</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of News Sources&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Publication Language&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="s1">&#39;German&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Breakdown of News Source Languages&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="" src="https://github.com/ERych/erych.github.io/blob/master/images/languages.JPG?raw=true&quot;"></p>
<p>Even though some of these countries are not primarily English-speaking, the article data is only in English and German.</p>
<h2>Google Translate API</h2>
<p>We are going to use the Google Translate API to translate any German-language articles captured in our News API request. In the next post, we will use the Google Natural Language API to perform sentiment and entity analysis on all of the articles.</p>
<h2>Google Cloud Platform (GCP) Authentication</h2>
<p>Authentication on GCP can be tricky, but these steps should guide you along the process. There are plenty on online resources if you get stuck (GCP documentation is robust and helpful).</p>
<p>We will use a service account to use the GCP API's.</p>
<h3>Steps to Enable Translation API:</h3>
<ol>
<li>Create a GCP account at https://console.cloud.google.com. If you have Google Account for gmail, you can use that.</li>
<li>Once logged into GCP, go to the console and create/select a project.</li>
<li>You will likely need to set up a billing account. Unless you are making many frequent requests, you won't be charged for API usage.</li>
<li>Open the console left side menu and select APIs &amp; services, and then select Library.</li>
<li>Click the Translation API under Google Cloud Machine Learning.</li>
<li>Click ENABLE.</li>
</ol>
<h3>Steps to Obtain API Credentials:</h3>
<ol>
<li>From the API and Services page you previously visited, click "Credentials" on the left side menu.</li>
<li>Under "Create Credentials" select "Service account key"</li>
<li>Create a new service account and make yourself the owner. Choose JSON for the key type.<br>
<img alt="" src="https://github.com/ERych/erych.github.io/blob/master/images/credentials.JPG?raw=true&quot;"></li>
<li>Click "Create" and the key will automatically download. Save this to your computer - don't lose it!</li>
</ol>
<h3>Making it Work in Python</h3>
<ol>
<li>Now that we are done in the GCP Console, we will download the GCP Client Library for Python (documentation [here]["https://googlecloudplatform.github.io/google-cloud-python/latest/"]).</li>
<li>I'm using Anaconda, so I use the Anaconda prompt to install the Translation client library.</li>
</ol>
<div class="highlight"><pre><span></span>$ pip install --upgrade google-cloud-translate
</pre></div>


<ol>
<li>We also need the OS library, so install that too.</li>
</ol>
<div class="highlight"><pre><span></span>$ pip install os
</pre></div>


<ol>
<li>Now, in python, import the libraries and set up your API key path.</li>
</ol>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">translate</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/Elizabeth Rychlinski/Documents/GW/DATS-6450/Project/googleAPI.json&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;GOOGLE_APPLICATION_CREDENTIALS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>


<ol>
<li>We will do a simple function to test it is working properly.</li>
</ol>
<div class="highlight"><pre><span></span><span class="c1"># define client</span>
<span class="n">translate_client</span> <span class="o">=</span> <span class="n">translate</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">translated_test</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">translate_client</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">target_language</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Translation&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;translatedText&#39;</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Source language: &#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;detectedSourceLanguage&#39;</span><span class="p">])</span>

<span class="n">text_test</span> <span class="o">=</span> <span class="s1">&#39;Hola amigo&#39;</span>
<span class="n">translated_test</span><span class="p">(</span><span class="n">text_test</span><span class="p">)</span>    
</pre></div>


<p>Output:
<img alt="" src="https://github.com/ERych/erych.github.io/blob/master/images/translation.JPG?raw=true&quot;"></p>
<h2>Translating articles</h2>
            <a href="#" class="go-top">Go Top</a>
<footer class="footer">
    <p>&copy; Elizabeth Rychlinski &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>

</body>
</html>